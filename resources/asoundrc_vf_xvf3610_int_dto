#
# Set up the playback hardware, rate is filled in by the setup script.
#
pcm.playback_hw {
    type hw
    card "Device"
    device 0
    format S32_LE
    channels 2
    rate {{rate}}
}

#
# Set up the capture hardware, rate is filled in by the setup script.
#
pcm.capture_hw {
    type hw
    card "Device"
    device 1
    format S32_LE
    channels 2
    rate {{rate}}
}

#
# Playback device.
# plug - rate and format conversion
# softvol - control for alsamixer
# dmix - allow device to be shared
#
pcm.XMOS_I2S_Playback {
    type plug
    slave.pcm {
        type softvol
        slave.pcm {
            type dmix
            ipc_key 256
            ipc_perm 0666
            slave.pcm "playback_hw"
        }
        control {
            name "Playback"
            card "Device"
        }
    }
}

#
# Comms & ASR recording.
#
pcm.XMOS_I2S_ASR_Comms_(LR) {
    type plug
    slave.pcm {
        type softvol
        slave.pcm {
            type dsnoop
            ipc_key 512
            ipc_perm 0666
            slave.pcm "capture_hw"
        }
        control {
            name "Record"
            card "Device"
        }
    }
}


#
# ASR recording.
#
pcm.XMOS_I2S_ASR_(L) {
    type plug
    slave.pcm {
        type softvol
        slave.pcm {
            type dsnoop
            ipc_key 512
            ipc_perm 0666
            slave.pcm "capture_hw"
            bindings [0]
        }
        control {
            name "Record"
            card "Device"
        }
    }
}

#
# Comms recording.
#
pcm.XMOS_I2S_Comms_(R) {
    type plug
    slave.pcm {
        type softvol
        slave.pcm {
            type dsnoop
            ipc_key 512
            ipc_perm 0666
            slave.pcm "capture_hw"
            bindings [1]
        }
        control {
            name "Record"
            card "Device"
        }
    }
}

#
# Default devices.
#
pcm.!default {
    type asym
    playback.pcm "XMOS_I2S_Playback"
    capture.pcm "XMOS_I2S_ASR_(L)"
}

#
# Aliases for compatibility
#

pcm.playback {
    type plug
    slave.pcm "XMOS_I2S_Playback"
}

pcm.capture {
    type plug
    slave.pcm "XMOS_I2S_ASR_(L)"
}
